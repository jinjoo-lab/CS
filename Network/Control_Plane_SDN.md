# Control Plane ( SDN )

### SDN ( 소프트웨어 정의 네트워크)

> 데이터 평면 스위치 - SDN 컨트롤러 - 네트워크 제어 애플리케이션
>

![image](https://github.com/jinjoo-lab/CS/assets/84346055/9f42c4b1-08b6-4807-8cea-8d5ba2d30460)

- 포워딩
    - 네트워크 계층의 출발지 / 목적지 주소
    - 링크 계층의 출발지 / 목적지 주소
    - 전송 계층과 네트워크 계층 , 링크 계층의 패킷 헤더 값

### 특징

- **플로우 기반 포워딩**
    - 라우터 기반 포워딩은 전통적인 방법으로 IP 데이터그램의 목적지 주소를 기반으로 수행
    - SDN에서의 패킷 전달은 링크 , 네트워크 , 전송 계층 등 다양한 계층의 값을 기반으로 수행 가능
        - 패킷 전달 규칙은 스위치 플로우 테이블에 기록되고 이러한 관리는 SDN 제어 평면의 역할
- **데이터 평면**과 **제어 평면**의 분리
    - 데이터 평면 : 플로우 **테이블 내용을 기반**으로 **매치 플러스 액션** 수행
    - 제어 평면 : 서버와 **플로우 테이블을 결정, 관리**하는 SW
- 네트워크 **제어 기능**이 **스위치 외부에 존재**
    - 제어 기능을 수행하는 SW가 네트워크 스위치로부터 떨어진 서버에서 수행
    - SDN 컨트롤러가 서버에 존재
        - 논지적 중앙 집중 형태 ( 협업 능력과 확장성, 높은 이용성을 갖도록 여러 서버에 존재 가능 )
- **프로그램 가능**
    - 네트워크 제어 애플리케이션을 통해 네트워크를 프로그램 가능
        - SDN이 제공하는 API 이용 → 데이터 평면 제어

### SDN 컨트롤러 + SDN 네트워크 제어 애플리케이션

> SDN 제어 평면은 **SDN 컨트롤러**와 **SDN 네트워크 제어 애플리케이션**으로 나뉜다.
>
- SDN 컨트롤러의 기능은 **3개의 계층**으로 구성
1. **통신 계층**
    - **SDN 컨트롤러**와 제어받는 **네트워크 장치들** 사이 통신
    - **사우스바운드 인터페이스**를 넘나들며 장치들과 컨트롤러 간 통신
2. **네트워크 전역 상태 관리 계층**
    - 컨트롤러는 제어 장치들의 테이블 복사본 유지
    - 네트워크 호스트 , 링크 , 스위치 , 플로우 테이블의 최신 정보 즉 상태 유지
3. **네트워크 제어 애플리케이션 계층과늬 인터페이스**
    - 노스바운드 인터페이스를 통해 네트워크 제어 애플리케이션과 상호작용
    - 플로우 테이블에 대한 읽기 + 쓰기 작업 전달

![image](https://github.com/jinjoo-lab/CS/assets/84346055/9f029e35-c7ff-407d-826f-6c0422098685)

### OpenFlow 프로토콜

> 통신 계층에서 사용 → SDN 컨트롤러와 제어 장치 사이 통신 프로토콜
>
- **컨트롤러 → 스위치** 전달 메시지
    - 설정
    - 상태 수정 ( 스위치 테이블 엔트리 수정 )
    - 상태 읽기 ( 스위치 테이블 엔트리 정보 읽기 )
    - 패킷 전송
- **스위치 → 컨트롤러** 전달 메시지
    - 플로우 제거
        - 플로우 테이블 엔트리 시간 만료
    - 포트 상태
        - 포트 상태 변화 전달
    - 패킷 전달

---

### OpenDaylight 컨트롤러

- SAL (Service Abstraction Layer)
    - **서비스 추상 계층**
    - 컨트롤러의 신경으로서 컨트롤러의 구성요소와 애플리케이션이 서로이 서비스를 호출하고 그들이 생성한 이벤트에 대한 알림을 받을 수 있다.
- 애플리케이션이 기본적인 **컨트롤러 서비스 장치**와 **상호작용**하는 2가지 방법 제공
    - AD-SAL
        - HTTP상에서 실행되는 REST 방식의 요청-응답 API 사용
    - MD-SAL
        - YANG 데이터 모델링 언어를 사용하여 장치 , 프로토콜, 네트워크 구성 및 작동 상태 데이터 모델 정의

### ONOS 컨트롤러

- **노스바운드 추상화 + 프로토콜**
    - 의도 프레임워크
        - 구체적 구현 상태를 모르더라도 서비스 제공 가능
        - 노스바운드 API를 통과하여 동기적 + 비동기적 기능 제공
- **분산 코어**
    - 네트워크 링크 , 호스트 , 장치의 상태는 ONOS의 분산 코어에 유지
- **사우스바운드 추상화 + 프로토콜**
    - 하부의 호스트, 링크 , 스위치, 프로토콜의 이질성을 숨김 → 분산 코어가 장치나 프로토콜 종류에 상관없이 작동
